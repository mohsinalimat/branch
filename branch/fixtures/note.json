[
 {
  "content": "<div class=\"ql-editor read-mode\"><p>frappe.ui.form.on(\"Appraisal Sheet\", {</p><p>&nbsp;&nbsp;appraisal_sheet_template_1: function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frm.doc.appraisal_sheet_goals_1 = []</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.call({</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method: \"frappe.client.get\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: frm.doc.appraisal_sheet_template_1,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doctype: \"Appraisal Sheet Template\"</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback(r) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (r.message) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (var row in r.message.appraisal_sheet_goals) {</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var child = frm.add_child(\"appraisal_sheet_goals_1\");</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(child.doctype, child.name, \"kra\", r.message.appraisal_sheet_goals[row].kra);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(child.doctype, child.name, \"qtr1_points\", r.message.appraisal_sheet_goals[row].qtr1_points);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh_field(\"appraisal_sheet_goals_1\");</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p><br></p><p><br></p><p>&nbsp;&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr1_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_points_total1(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr1_points_total1(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>});</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_points_total1(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr1_points_total1(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr1_points_total1 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr1_points_total1 += flt(d.qtr1_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr1_points_total1\",qtr1_points_total1)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr2_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_points_total1(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr2_points_total1(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>});</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_points_total1(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr2_points_total1(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr2_points_total1 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr2_points_total1 += flt(d.qtr2_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr2_points_total1\",qtr2_points_total1)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr3_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_points_total1(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr3_points_total1(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>});</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_points_total1(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr3_points_total1(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr3_points_total1 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr3_points_total1 += flt(d.qtr3_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr3_points_total1\",qtr3_points_total1)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr4_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_points_total1(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr4_points_total1(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>});</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_points_total1(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr4_points_total1(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr4_points_total1 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr4_points_total1 += flt(d.qtr4_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr4_points_total1\",qtr4_points_total1)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals',{</p><p><br></p><p>&nbsp;qtr4_points: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc1 = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"annual_performance\",parseFloat(doc1.qtr1_points + doc1.qtr2_points + doc1.qtr3_points + doc1.qtr4_points));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;annual_performance: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_points_total1(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_allqtr_points_total1(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>});</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_points_total1(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_allqtr_points_total1(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var allqtr_points_total1 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allqtr_points_total1 += flt(d.annual_performance)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"allqtr_points_total1\",allqtr_points_total1)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Appraisal Sheet\", {</p><p>&nbsp;&nbsp;appraisal_sheet_template_2: function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frm.doc.appraisal_sheet_goals_2 = []</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.call({</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method: \"frappe.client.get\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: frm.doc.appraisal_sheet_template_2,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doctype: \"Appraisal Sheet Template\"</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback(r) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (r.message) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (var row in r.message.appraisal_sheet_goals) {</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var child = frm.add_child(\"appraisal_sheet_goals_2\");</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(child.doctype, child.name, \"kra\", r.message.appraisal_sheet_goals[row].kra);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(child.doctype, child.name, \"qtr1_points\", r.message.appraisal_sheet_goals[row].qtr1_points);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh_field(\"appraisal_sheet_goals_2\");</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr1_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_points_total2(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr1_points_total2(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_points_total2(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr1_points_total2(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr1_points_total2 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr1_points_total2 += flt(d.qtr1_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr1_points_total2\",qtr1_points_total2)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>//per row = 5</p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr1_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_total_marks(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr1_total_marks(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_total_marks(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr1_total_marks(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr1_total_marks = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr1_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr1_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr1_total_marks\",qtr1_total_marks)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>//per row = 5</p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr2_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_total_marks(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr2_total_marks(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_total_marks(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr2_total_marks(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr2_total_marks = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr2_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr2_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr2_total_marks\",qtr2_total_marks)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>//per row = 5</p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr3_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_total_marks(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr3_total_marks(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_total_marks(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr3_total_marks(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr3_total_marks = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr3_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr3_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr3_total_marks\",qtr3_total_marks)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>//per row = 5</p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr4_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_total_marks(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr4_total_marks(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_total_marks(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr4_total_marks(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr4_total_marks = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr4_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr4_total_marks += flt(5)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr4_total_marks\",qtr4_total_marks)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>//per row = 20</p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;allqtr_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_total_marks(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_allqtr_total_marks(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_total_marks(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_allqtr_total_marks(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var allqtr_total_marks = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_1, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allqtr_total_marks += flt(20)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allqtr_total_marks += flt(20)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"allqtr_total_marks\",allqtr_total_marks)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr2_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_points_total2(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr2_points_total2(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_points_total2(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr2_points_total2(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr2_points_total2 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr2_points_total2 += flt(d.qtr2_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr2_points_total2\",qtr2_points_total2)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr3_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_points_total2(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr3_points_total2(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_points_total2(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr3_points_total2(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr3_points_total2 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr3_points_total2 += flt(d.qtr3_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr3_points_total2\",qtr3_points_total2)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr4_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_points_total2(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr4_points_total2(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_points_total2(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr4_points_total2(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr4_points_total2 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr4_points_total2 += flt(d.qtr4_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr4_points_total2\",qtr4_points_total2)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;annual_performance: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_points_total2(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_allqtr_points_total2(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_points_total2(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_allqtr_points_total2(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var allqtr_points_total2 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_2, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allqtr_points_total2 += flt(d.annual_performance)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"allqtr_points_total2\",allqtr_points_total2)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr1_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr1_marks_obtained\",parseFloat(doc.qtr1_points_total1 + doc.qtr1_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr1_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr1_marks_obtained\",parseFloat(doc.qtr1_points_total1 + doc.qtr1_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr2_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr2_marks_obtained\",parseFloat(doc.qtr2_points_total1 + doc.qtr2_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr2_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr2_marks_obtained\",parseFloat(doc.qtr2_points_total1 + doc.qtr2_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr3_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr3_marks_obtained\",parseFloat(doc.qtr3_points_total1 + doc.qtr3_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr3_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr3_marks_obtained\",parseFloat(doc.qtr3_points_total1 + doc.qtr3_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr4_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr4_marks_obtained\",parseFloat(doc.qtr4_points_total1 + doc.qtr4_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr4_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr4_marks_obtained\",parseFloat(doc.qtr4_points_total1 + doc.qtr4_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;allqtr_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"allqtr_marks_obtained\",parseFloat(doc.allqtr_points_total1 + doc.allqtr_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;allqtr_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"allqtr_marks_obtained\",parseFloat(doc.allqtr_points_total1 + doc.allqtr_points_total2));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr1_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr1_percentage\",parseFloat((doc.qtr1_marks_obtained * 100) / doc.qtr1_total_marks));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>&nbsp;</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr2_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr2_percentage\",parseFloat((doc.qtr2_marks_obtained * 100) / doc.qtr2_total_marks));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>&nbsp;</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr3_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr3_percentage\",parseFloat((doc.qtr3_marks_obtained * 100) / doc.qtr3_total_marks));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>&nbsp;</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr4_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr4_percentage\",parseFloat((doc.qtr4_marks_obtained * 100) / doc.qtr4_total_marks));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>&nbsp;</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;allqtr_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"allqtr_percentage\",parseFloat((doc.allqtr_marks_obtained * 100) / doc.allqtr_total_marks));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>&nbsp;</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Appraisal Sheet\", {</p><p>&nbsp;&nbsp;appraisal_sheet_template_3: function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frm.doc.appraisal_sheet_goals_3 = []</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.call({</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method: \"frappe.client.get\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: frm.doc.appraisal_sheet_template_3,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doctype: \"Appraisal Sheet Template\"</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback(r) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (r.message) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (var row in r.message.appraisal_sheet_goals) {</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var child = frm.add_child(\"appraisal_sheet_goals_3\");</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(child.doctype, child.name, \"kra\", r.message.appraisal_sheet_goals[row].kra);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(child.doctype, child.name, \"qtr1_points\", r.message.appraisal_sheet_goals[row].qtr1_points);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh_field(\"appraisal_sheet_goals_3\");</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr1_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_points_total3(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr1_points_total3(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr1_points_total3(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr1_points_total3(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr1_points_total3 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_3, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr1_points_total3 += flt(d.qtr1_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr1_points_total3\",qtr1_points_total3)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr2_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_points_total3(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr2_points_total3(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr2_points_total3(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr2_points_total3(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr2_points_total3 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_3, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr2_points_total3 += flt(d.qtr2_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr2_points_total3\",qtr2_points_total3)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr3_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_points_total3(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr3_points_total3(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr3_points_total3(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr3_points_total3(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr3_points_total3 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_3, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr3_points_total3 += flt(d.qtr3_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr3_points_total3\",qtr3_points_total3)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;qtr4_points: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_points_total3(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_qtr4_points_total3(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_qtr4_points_total3(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_qtr4_points_total3(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var qtr4_points_total3 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_3, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qtr4_points_total3 += flt(d.qtr4_points)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"qtr4_points_total3\",qtr4_points_total3)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet Goals', {</p><p>&nbsp;&nbsp;annual_performance: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_points_total3(cur_frm)</p><p><br></p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;kra: function(frm,cdt,cdn){</p><p>&nbsp;setTimeout(function(){&nbsp;set_allqtr_points_total3(cur_frm) },1500);</p><p><br></p><p>&nbsp;&nbsp;}</p><p>})</p><p>frappe.ui.form.on('Appraisal Sheet', {</p><p>&nbsp;&nbsp;validate: function(frm,cdt,cdn) {</p><p><br></p><p>set_allqtr_points_total3(frm)</p><p>&nbsp;}</p><p>})</p><p><br></p><p>function set_allqtr_points_total3(frm) {</p><p>var doc = locals[frm.doc.doctype][frm.doc.name]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var allqtr_points_total3 = 0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$.each(doc.appraisal_sheet_goals_3, function(i, d) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allqtr_points_total3 += flt(d.annual_performance)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>frm.set_value(\"allqtr_points_total3\",allqtr_points_total3)</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr1_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr1_final_marks_obtained\",parseFloat(doc.qtr1_points_total1 + doc.qtr1_points_total2 + doc.qtr1_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr1_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr1_final_marks_obtained\",parseFloat(doc.qtr1_points_total1 + doc.qtr1_points_total2 + doc.qtr1_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;qtr1_points_total3: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr1_final_marks_obtained\",parseFloat(doc.qtr1_points_total1 + doc.qtr1_points_total2 + doc.qtr1_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr2_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr2_final_marks_obtained\",parseFloat(doc.qtr2_points_total1 + doc.qtr2_points_total2 + doc.qtr2_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr2_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr2_final_marks_obtained\",parseFloat(doc.qtr2_points_total1 + doc.qtr2_points_total2 + doc.qtr2_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;qtr2_points_total3: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr2_final_marks_obtained\",parseFloat(doc.qtr2_points_total1 + doc.qtr2_points_total2 + doc.qtr2_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr3_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr3_final_marks_obtained\",parseFloat(doc.qtr3_points_total1 + doc.qtr3_points_total2 + doc.qtr3_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr3_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr3_final_marks_obtained\",parseFloat(doc.qtr3_points_total1 + doc.qtr3_points_total2 + doc.qtr3_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;qtr3_points_total3: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr3_final_marks_obtained\",parseFloat(doc.qtr3_points_total1 + doc.qtr3_points_total2 + doc.qtr3_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr4_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr4_final_marks_obtained\",parseFloat(doc.qtr4_points_total1 + doc.qtr4_points_total2 + doc.qtr4_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;qtr4_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr4_final_marks_obtained\",parseFloat(doc.qtr4_points_total1 + doc.qtr4_points_total2 + doc.qtr4_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;qtr4_points_total3: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr4_final_marks_obtained\",parseFloat(doc.qtr4_points_total1 + doc.qtr4_points_total2 + doc.qtr4_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;allqtr_points_total1: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"allqtr_final_marks_obtained\",parseFloat(doc.allqtr_points_total1 + doc.allqtr_points_total2 + doc.allqtr_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;</p><p>&nbsp;allqtr_points_total2: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"allqtr_final_marks_obtained\",parseFloat(doc.allqtr_points_total1 + doc.allqtr_points_total2 + doc.allqtr_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;},</p><p>&nbsp;allqtr_points_total3: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"allqtr_final_marks_obtained\",parseFloat(doc.allqtr_points_total1 + doc.allqtr_points_total2 + doc.allqtr_points_total3));</p><p>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr1_final_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr1_final_percentage\",parseFloat((doc.qtr1_final_marks_obtained * 100) / doc.qtr1_final_total_marks));</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr2_final_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr2_final_percentage\",parseFloat((doc.qtr2_final_marks_obtained * 100) / doc.qtr2_final_total_marks));</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr3_final_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr3_final_percentage\",parseFloat((doc.qtr3_final_marks_obtained * 100) / doc.qtr3_final_total_marks));</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;qtr4_final_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"qtr4_final_percentage\",parseFloat((doc.qtr4_final_marks_obtained * 100) / doc.qtr4_final_total_marks));</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on('Appraisal Sheet',{</p><p><br></p><p>&nbsp;allqtr_final_marks_obtained: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt,cdn,\"allqtr_final_percentage\",parseFloat((doc.allqtr_final_marks_obtained * 100) / doc.allqtr_final_total_marks));</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>// Point must be less than or equal to 5</p><p>cur_frm.cscript.qtr1_points = function(doc,cdt,cdn){</p><p>var d = locals[cdt][cdn];</p><p>if (d.qtr1_points){</p><p>&nbsp;if (flt(d.qtr1_points) &gt; 5) {</p><p>&nbsp;frappe.msgprint(__(\"Point must be less than or equal to 5\"));</p><p>&nbsp;d.qtr1_points = 0;</p><p>&nbsp;refresh_field('qtr1_points', d.name, 'appraisal_sheet_goals_1');</p><p>&nbsp;refresh_field('qtr1_points', d.name, 'appraisal_sheet_goals_2');</p><p>&nbsp;refresh_field('qtr1_points', d.name, 'appraisal_sheet_goals_3');</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>}</p><p><br></p><p>cur_frm.cscript.qtr2_points = function(doc,cdt,cdn){</p><p>var d = locals[cdt][cdn];</p><p>if (d.qtr2_points){</p><p>&nbsp;if (flt(d.qtr2_points) &gt; 5) {</p><p>&nbsp;frappe.msgprint(__(\"Point must be less than or equal to 5\"));</p><p>&nbsp;d.qtr2_points = 0;</p><p>&nbsp;refresh_field('qtr2_points', d.name, 'appraisal_sheet_goals_1');</p><p>&nbsp;refresh_field('qtr2_points', d.name, 'appraisal_sheet_goals_2');</p><p>&nbsp;refresh_field('qtr2_points', d.name, 'appraisal_sheet_goals_3');</p><p>&nbsp;}</p><p>}</p><p>}</p><p><br></p><p>cur_frm.cscript.qtr3_points = function(doc,cdt,cdn){</p><p>var d = locals[cdt][cdn];</p><p>if (d.qtr3_points){</p><p>&nbsp;if (flt(d.qtr3_points) &gt; 5) {</p><p>&nbsp;frappe.msgprint(__(\"Point must be less than or equal to 5\"));</p><p>&nbsp;d.qtr3_points = 0;</p><p>&nbsp;refresh_field('qtr3_points', d.name, 'appraisal_sheet_goals_1');</p><p>&nbsp;refresh_field('qtr3_points', d.name, 'appraisal_sheet_goals_2');</p><p>&nbsp;refresh_field('qtr3_points', d.name, 'appraisal_sheet_goals_3');</p><p>&nbsp;}</p><p>}</p><p>}</p><p><br></p><p>cur_frm.cscript.qtr4_points = function(doc,cdt,cdn){</p><p>var d = locals[cdt][cdn];</p><p>if (d.qtr4_points){</p><p>&nbsp;if (flt(d.qtr4_points) &gt; 5) {</p><p>&nbsp;frappe.msgprint(__(\"Point must be less than or equal to 5\"));</p><p>&nbsp;d.qtr4_points = 0;</p><p>&nbsp;refresh_field('qtr4_points', d.name, 'appraisal_sheet_goals_1');</p><p>&nbsp;refresh_field('qtr4_points', d.name, 'appraisal_sheet_goals_2');</p><p>&nbsp;refresh_field('qtr4_points', d.name, 'appraisal_sheet_goals_3');</p><p>&nbsp;}</p><p>}</p><p>}</p></div>",
  "docstatus": 0,
  "doctype": "Note",
  "expire_notification_on": null,
  "modified": "2022-02-07 10:34:49.470779",
  "name": "Script",
  "notify_on_every_login": 0,
  "notify_on_login": 0,
  "public": 1,
  "seen_by": [],
  "title": "Script"
 },
 {
  "content": "<div class=\"ql-editor read-mode\"><p><br></p><p>erpnext.SMSManager = function SMSManager(doc) {</p><p>var me = this;</p><p>this.setup = function() {</p><p>&nbsp;var default_msg = {</p><p>&nbsp;'Lead'&nbsp;&nbsp;: '',</p><p>&nbsp;'Opportunity'&nbsp;: 'Your enquiry has been logged into the system. Ref No: ' + doc.name,</p><p>&nbsp;'Quotation'&nbsp;: 'Quotation ' + doc.name + ' has been sent via email. Thanks!',</p><p>&nbsp;'Sales Order'&nbsp;: 'Sales Order ' + doc.name + ' has been created against '</p><p>&nbsp;&nbsp;&nbsp;+ (doc.quotation_no ? ('Quote No:' + doc.quotation_no) : '')</p><p>&nbsp;&nbsp;&nbsp;+ (doc.po_no ? (' for your PO: ' + doc.po_no) : ''),</p><p>&nbsp;'Delivery Note'&nbsp;: 'Items has been delivered against delivery note: ' + doc.name</p><p>&nbsp;&nbsp;&nbsp;+ (doc.po_no ? (' for your PO: ' + doc.po_no) : ''),</p><p><br></p><p>&nbsp;'Sales Invoice': 'Dear M/s. '+ doc.customer + ', Your Invoice No. ' + doc.name + ', Date: ' + doc.posting_date +' dispatched in ' + doc.transporter</p><p>&nbsp;+ ', LR No. ' + doc. lr_no+ ', LR Date: ' + doc.lr_date+ ', Parcel: ' +doc.total_parcel +</p><p>&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thanks by Prince Care Pharma Pvt. Ltd.',</p><p>&nbsp;'Material Request'&nbsp;: 'Material Request ' + doc.name + ' has been raised in the system',</p><p>&nbsp;'Purchase Order'\t: 'Purchase Order ' + doc.name + ' has been sent via email',</p><p>&nbsp;'Purchase Receipt'\t: 'Items has been received against purchase receipt: ' + doc.name</p><p>&nbsp;}</p><p><br></p><p>&nbsp;if (in_list(['Sales Order', 'Delivery Note', 'Sales Invoice'], doc.doctype))</p><p>&nbsp;this.show(doc.contact_person, 'Customer', doc.customer, '', default_msg[doc.doctype]);</p><p>&nbsp;else if (doc.doctype === 'Quotation')</p><p>&nbsp;this.show(doc.contact_person, 'Customer', doc.party_name, '', default_msg[doc.doctype]);</p><p>&nbsp;else if (in_list(['Purchase Order', 'Purchase Receipt'], doc.doctype))</p><p>&nbsp;this.show(doc.contact_person, 'Supplier', doc.supplier, '', default_msg[doc.doctype]);</p><p>&nbsp;else if (doc.doctype == 'Lead')</p><p>&nbsp;this.show('', '', '', doc.mobile_no, default_msg[doc.doctype]);</p><p>&nbsp;else if (doc.doctype == 'Opportunity')</p><p>&nbsp;this.show('', '', '', doc.contact_no, default_msg[doc.doctype]);</p><p>&nbsp;else if (doc.doctype == 'Material Request')</p><p>&nbsp;this.show('', '', '', '', default_msg[doc.doctype]);</p><p><br></p><p>};</p><p><br></p><p>this.get_contact_number = function(contact, ref_doctype, ref_name) {</p><p>&nbsp;frappe.call({</p><p>&nbsp;method: \"frappe.core.doctype.sms_settings.sms_settings.get_contact_number\",</p><p>&nbsp;args: {</p><p>&nbsp;&nbsp;contact_name: contact,</p><p>&nbsp;&nbsp;ref_doctype: ref_doctype,</p><p>&nbsp;&nbsp;ref_name: ref_name</p><p>&nbsp;},</p><p>&nbsp;callback: function(r) {</p><p>&nbsp;&nbsp;if(r.exc) { frappe.msgprint(r.exc); return; }</p><p>&nbsp;&nbsp;me.number = r.message;</p><p>&nbsp;&nbsp;me.show_dialog();</p><p>&nbsp;}</p><p>&nbsp;});</p><p>};</p><p><br></p><p>this.show = function(contact, ref_doctype, ref_name, mobile_nos, message) {</p><p>&nbsp;this.message = message;</p><p>&nbsp;if (mobile_nos) {</p><p>&nbsp;me.number = mobile_nos;</p><p>&nbsp;me.show_dialog();</p><p>&nbsp;} else if (contact){</p><p>&nbsp;this.get_contact_number(contact, ref_doctype, ref_name)</p><p>&nbsp;} else {</p><p>&nbsp;me.show_dialog();</p><p>&nbsp;}</p><p>}</p><p>this.show_dialog = function() {</p><p>&nbsp;if(!me.dialog)</p><p>&nbsp;me.make_dialog();</p><p>&nbsp;me.dialog.set_values({</p><p>&nbsp;'message': me.message,</p><p>&nbsp;'number': me.number</p><p>&nbsp;})</p><p>&nbsp;me.dialog.show();</p><p>}</p><p>this.make_dialog = function() {</p><p>&nbsp;var d = new frappe.ui.Dialog({</p><p>&nbsp;title: 'Send SMS',</p><p>&nbsp;width: 400,</p><p>&nbsp;fields: [</p><p>&nbsp;&nbsp;{fieldname:'number', fieldtype:'Data', label:'Mobile Number', reqd:1},</p><p>&nbsp;&nbsp;{fieldname:'message', fieldtype:'Text', label:'Message', reqd:1},</p><p>&nbsp;&nbsp;{fieldname:'send', fieldtype:'Button', label:'Send'}</p><p>&nbsp;]</p><p>&nbsp;})</p><p>&nbsp;d.fields_dict.send.input.onclick = function() {</p><p>&nbsp;var btn = d.fields_dict.send.input;</p><p>&nbsp;var v = me.dialog.get_values();</p><p>&nbsp;if(v) {</p><p>&nbsp;&nbsp;$(btn).set_working();</p><p>&nbsp;&nbsp;frappe.call({</p><p>&nbsp;&nbsp;method: \"frappe.core.doctype.sms_settings.sms_settings.send_sms\",</p><p>&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;receiver_list: [v.number],</p><p>&nbsp;&nbsp;&nbsp;msg: v.message</p><p>&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;callback: function(r) {</p><p>&nbsp;&nbsp;&nbsp;$(btn).done_working();</p><p>&nbsp;&nbsp;&nbsp;if(r.exc) {frappe.msgprint(r.exc); return; }</p><p>&nbsp;&nbsp;&nbsp;me.dialog.hide();</p><p>&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;});</p><p>&nbsp;}</p><p>&nbsp;}</p><p>&nbsp;this.dialog = d;</p><p>}</p><p>this.setup();</p><p>}</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>/*</p><p>Dear M/s. Raj Medico Agency, Your Invoice No. SIN-1950, Date: 06-08-2021 is dispatched in Swaraj Logistics Pvt Ltd. LR No.25017159, LR Date: 11-08-2021 Parcel 1.</p><p><br></p><p>Thanks By Prince Care Pharma</p><p>*/</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p>/*frappe.ui.form.on(\"Sales Invoice Item\", \"item_code\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var d = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.db.get_value(\"Item\", {\"name\": d.item_code}, \"qty_in_box\", function(value) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.qty_in_box = d.qty / value.qty_in_box;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>});</p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"qty\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var d = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.db.get_value(\"Item\", {\"name\": d.item_code}, \"qty_in_box\", function(value) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.qty_in_box = d.qty / value.qty_in_box;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>});</p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"item_code\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var d = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.db.get_value(\"Item\", {\"name\": d.item_code}, \"qty_in_case\", function(value) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.qty_in_case = d.qty / value.qty_in_case;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>});</p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"qty\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var d = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.db.get_value(\"Item\", {\"name\": d.item_code}, \"qty_in_case\", function(value) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.qty_in_case = d.qty / value.qty_in_case;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"item_code\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var d = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.db.get_value(\"Item\", {\"name\": d.item_code}, \"qty_in_case\", function(value) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.packs_shipper = value.qty_in_case / d.units_pack;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>});</p><p><br></p><p><br></p><p>/*</p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"form_render\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;frappe.model.set_value(cdt, cdn, 'cbm',parseFloat(doc.length * doc.breadth * doc.height) / 1000000);</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"form_render\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;frappe.model.set_value(cdt, cdn, 'total_cbm', parseFloat(doc.cbm * doc.qty_in_case));</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"form_render\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;frappe.model.set_value(cdt, cdn, 'total_net_wt', parseFloat(doc.net_wt_per_shipper * doc.qty_in_case));</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"form_render\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;frappe.model.set_value(cdt, cdn, 'total_gross_wt', parseFloat(doc.gross_wt_per_shipper * doc.qty_in_case));</p><p>});</p><p>*/</p><p><br></p><p><br></p><p><br></p><p>/*</p><p>frappe.ui.form.on(\"Sales Invoice Item\", \"validate\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;frappe.model.set_value(cdt, cdn, 'total_cbm', parseFloat((doc.qty / doc.total_qty_per_shipper) * ((doc.length * doc.breadth * doc.height) / 1000000)));</p><p>});*/</p><p><br></p><p>frappe.ui.form.on('Sales Invoice Item',{</p><p><br></p><p>&nbsp;free_item: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;if(doc.free_item == 1){</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt, cdn, 'price_list_rate', 0);</p><p>&nbsp;}</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on('Sales Invoice',{</p><p><br></p><p>&nbsp;before_save: function(frm,cdt,cdn) {</p><p>&nbsp;&nbsp;&nbsp;var doc = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;if(!frm.doc.date_removal){</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frappe.model.set_value(cdt, cdn, 'date_removal', doc.posting_date);</p><p>&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;}</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice\", \"validate\", function(frm, cdt, cdn) {</p><p>$.each(frm.doc.items || [], function(i, d) {</p><p>&nbsp;if(d.rate &lt;= 0 &amp;&amp; d.free_item != 1) {</p><p>&nbsp;frappe.msgprint('&lt;b&gt;'+d.item_code+'&lt;/b&gt;' +\" Rate is 0\" + d.qty);</p><p>&nbsp;validated = false;</p><p>&nbsp;}</p><p>})</p><p>});</p><p><br></p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice\", \"notify_party_address\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;if(frm.doc.notify_party_address){</p><p>&nbsp;&nbsp;return frm.call({</p><p>&nbsp;&nbsp;&nbsp;method: \"frappe.contacts.doctype.address.address.get_address_display\",</p><p>&nbsp;&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;\"address_dict\": frm.doc.notify_party_address</p><p>&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;callback: function(r) {</p><p>&nbsp;&nbsp;&nbsp;if(r.message)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frm.set_value(\"notify_address\", r.message);</p><p>&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;else{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frm.set_value(\"notify_address\", \"\");</p><p>&nbsp;&nbsp;}</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice\", {</p><p>setup: function(frm) {</p><p>&nbsp;frm.set_query(\"notify_party_address\", function()</p><p>&nbsp;{</p><p>&nbsp;return {</p><p>&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;filters: [</p><p>&nbsp;&nbsp;[\"Dynamic Link\",\"link_doctype\", \"=\", \"Customer\"],</p><p>&nbsp;&nbsp;[\"Dynamic Link\",\"link_name\", \"=\", frm.doc.customer]</p><p>&nbsp;&nbsp;]</p><p>&nbsp;}</p><p>&nbsp;});</p><p>}</p><p>});</p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice\", \"bank_account_address\", function(frm, cdt, cdn) {</p><p>&nbsp;&nbsp;if(frm.doc.bank_account_address){</p><p>&nbsp;&nbsp;return frm.call({</p><p>&nbsp;&nbsp;&nbsp;method: \"frappe.contacts.doctype.address.address.get_address_display\",</p><p>&nbsp;&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;\"address_dict\": frm.doc.bank_account_address</p><p>&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;callback: function(r) {</p><p>&nbsp;&nbsp;&nbsp;if(r.message)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frm.set_value(\"bank_address\", r.message);</p><p>&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;else{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;frm.set_value(\"bank_address\", \"\");</p><p>&nbsp;&nbsp;}</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice\", {</p><p>setup: function(frm) {</p><p>&nbsp;frm.set_query(\"bank_account_address\", function()</p><p>&nbsp;{</p><p>&nbsp;return {</p><p>&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;filters: [</p><p>&nbsp;&nbsp;[\"Dynamic Link\",\"link_doctype\", \"=\", \"Bank Account\"]</p><p>&nbsp;&nbsp;/*,</p><p>&nbsp;&nbsp;[\"Dynamic Link\",\"link_name\", \"=\", frm.doc.customer]*/</p><p>&nbsp;&nbsp;]</p><p>&nbsp;}</p><p>&nbsp;});</p><p>}</p><p>});</p><p><br></p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Sales Invoice Item\",</p><p>&nbsp;&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;item_code: function(frm, cdt, cdn)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</p><p>&nbsp;var d = locals[cdt][cdn];</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(\"Costo : \" + d.costo + \" y Item Code: \" + d.item_code);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.call(</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method: \"frappe.client.get_value\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doctype: \"Item Price\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filters: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// price_list: frm.doc.mrp_price_list,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;price_list: \"MRP\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_code: d.item_code</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldname:[\"price_list_rate\"]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback: function(r)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(r.message)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var item_price = r.message;</p><p>&nbsp;&nbsp;console.log(\"mrp: \" + item_price.price_list_rate);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.mrp = item_price.price_list_rate;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;}</p><p>);</p></div>",
  "docstatus": 0,
  "doctype": "Note",
  "expire_notification_on": null,
  "modified": "2022-02-07 10:35:36.492145",
  "name": "Sales Invoice Script",
  "notify_on_every_login": 0,
  "notify_on_login": 0,
  "public": 1,
  "seen_by": [],
  "title": "Sales Invoice Script"
 },
 {
  "content": "<div class=\"ql-editor read-mode\"><p>frappe.ui.form.on(\"Sales Invoice\", \"on_submit\", function(frm) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.each(cur_frm.doc.items || [], function(i, v) { // for each item on table do this</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var precoAntigo;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.call({</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method: \"frappe.client.get_list\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args: {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doctype: \"Item Price\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filters: [</p><p>&nbsp;// <span style=\"background-color: rgb(248, 248, 248); color: rgb(51, 51, 51);\">['price_list', \"=\", cur_frm.doc.selling_price_list],</span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;['price_list', \"=\", \"MRP\"],</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\"item_code\", \"=\", v.item_code],</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields: [</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"price_list_rate\",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"name\"</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback: function(r) { // do this to found price list doc</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precoAntigo = (r.message[0].price_list_rate);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var nomelista = r.message[0].name</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// console.log(precoAntigo)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (precoAntigo &amp;&amp; precoAntigo != v.rate) {</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.confirm(</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`Deseja atualizar o pre\u00e7o do item ${v.item_name} de ${ precoAntigo } para ${ v.rate} na lista de pre\u00e7os ${cur_frm.doc.selling_price_list} ?`, //ask something to update price</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function() { // do this if ok</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frappe.db.set_value(\"Item Price\", nomelista, \"price_list_rate\", v.rate)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function() { // do nothing if cancel</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</p><p>})</p></div>",
  "docstatus": 0,
  "doctype": "Note",
  "expire_notification_on": null,
  "modified": "2022-02-07 10:36:55.750865",
  "name": "Automate updating of price list",
  "notify_on_every_login": 0,
  "notify_on_login": 0,
  "public": 1,
  "seen_by": [],
  "title": "Automate updating of price list"
 },
 {
  "content": "<div class=\"ql-editor read-mode\"><p>You are seeing this message because Shopping Cart is enabled on your site. </p><p><br></p><p>Shopping Cart Settings and Products settings are now merged into \"E Commerce Settings\". </p><p><br></p><p>You can learn about new and improved E-Commerce features in the official documentation.</p><ol><li data-list=\"bullet\"><span class=\"ql-ui\" contenteditable=\"false\"></span><a href=\"https://docs.erpnext.com/docs/v13/user/manual/en/e_commerce/set_up_e_commerce\" rel=\"noopener noreferrer\">https://docs.erpnext.com/docs/v13/user/manual/en/e_commerce/set_up_e_commerce</a></li></ol><p><br></p></div>",
  "docstatus": 0,
  "doctype": "Note",
  "expire_notification_on": "2022-02-14",
  "modified": "2022-02-07 16:45:59.233844",
  "name": "New E-Commerce Module",
  "notify_on_every_login": 0,
  "notify_on_login": 1,
  "public": 1,
  "seen_by": [
   {
    "parent": "New E-Commerce Module",
    "parentfield": "seen_by",
    "parenttype": "Note",
    "user": "n.patel.serpentcs@gmail.com"
   },
   {
    "parent": "New E-Commerce Module",
    "parentfield": "seen_by",
    "parenttype": "Note",
    "user": "Administrator"
   }
  ],
  "title": "New E-Commerce Module"
 },
 {
  "content": "<div class=\"ql-editor read-mode\"><p>frappe.ui.form.on(\"Stock Entry\", \"onload\", function(frm) {</p><p> &nbsp; &nbsp;frm.set_query(\"company_branch\", function() {</p><p> &nbsp; &nbsp; &nbsp; &nbsp;return {</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"filters\": {</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"company\": frm.doc.company</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p><p> &nbsp; &nbsp; &nbsp; &nbsp;};</p><p> &nbsp; &nbsp;});</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Stock Entry\", \"company_branch\", function(frm) {</p><p> &nbsp; &nbsp;frm.set_query(\"from_warehouse\", function() {</p><p> &nbsp; &nbsp; &nbsp; &nbsp;if(frm.doc.stock_entry_type != \"Material Transfer\"){</p><p> &nbsp; &nbsp; &nbsp; &nbsp;return {</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"filters\": {</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"company\": frm.doc.company,</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"company_branch\": frm.doc.company_branch</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};</p><p> &nbsp; &nbsp; &nbsp; &nbsp;}</p><p> &nbsp; &nbsp;});</p><p>});</p><p><br></p><p><br></p><p>frappe.ui.form.on(\"Stock Entry\", \"company_branch\", function(frm) {</p><p> &nbsp; &nbsp;frm.set_query(\"to_warehouse\", function() {</p><p> &nbsp; &nbsp; &nbsp; // if(frm.doc.stock_entry_type != \"Material Transfer\"){</p><p> &nbsp; &nbsp; &nbsp; &nbsp;return {</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"filters\": {</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"company\": frm.doc.company,</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\"company_branch\": frm.doc.company_branch</p><p> &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp; }</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p><p> &nbsp; &nbsp; &nbsp; &nbsp;};</p><p> &nbsp; &nbsp;});</p><p>});</p></div>",
  "docstatus": 0,
  "doctype": "Note",
  "expire_notification_on": null,
  "modified": "2022-02-09 16:27:03.320434",
  "name": "Localhost Stock Entry Script",
  "notify_on_every_login": 0,
  "notify_on_login": 0,
  "public": 1,
  "seen_by": [],
  "title": "Localhost Stock Entry Script"
 }
]